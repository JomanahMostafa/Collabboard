import{R as y,a as C,p as b}from"./chunk-UIGDSWPH-DxYnQsBD.js";import{d as D}from"./Card-DpraJusS.js";const O=s=>{let o;const e=new Set,t=(c,f)=>{const i=typeof c=="function"?c(o):c;if(!Object.is(i,o)){const p=o;o=f??(typeof i!="object"||i===null)?i:Object.assign({},o,i),e.forEach(h=>h(o,p))}},r=()=>o,u={setState:t,getState:r,getInitialState:()=>d,subscribe:c=>(e.add(c),()=>e.delete(c))},d=o=s(t,r,u);return u},T=(s=>s?O(s):O),N=s=>s;function j(s,o=N){const e=y.useSyncExternalStore(s.subscribe,y.useCallback(()=>o(s.getState()),[s,o]),y.useCallback(()=>o(s.getInitialState()),[s,o]));return y.useDebugValue(e),e}const U=s=>{const o=T(s),e=t=>j(o,t);return Object.assign(e,o),e},B=(s=>U);function E(s,o){let e;try{e=s()}catch{return}return{getItem:r=>{var n;const a=d=>d===null?null:JSON.parse(d,void 0),u=(n=e.getItem(r))!=null?n:null;return u instanceof Promise?u.then(a):a(u)},setItem:(r,n)=>e.setItem(r,JSON.stringify(n,void 0)),removeItem:r=>e.removeItem(r)}}const w=s=>o=>{try{const e=s(o);return e instanceof Promise?e:{then(t){return w(t)(e)},catch(t){return this}}}catch(e){return{then(t){return this},catch(t){return w(t)(e)}}}},R=(s,o)=>(e,t,r)=>{let n={storage:E(()=>localStorage),partialize:l=>l,version:0,merge:(l,S)=>({...S,...l}),...o},a=!1;const u=new Set,d=new Set;let c=n.storage;if(!c)return s((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),e(...l)},t,r);const f=()=>{const l=n.partialize({...t()});return c.setItem(n.name,{state:l,version:n.version})},i=r.setState;r.setState=(l,S)=>(i(l,S),f());const p=s((...l)=>(e(...l),f()),t,r);r.getInitialState=()=>p;let h;const x=()=>{var l,S;if(!c)return;a=!1,u.forEach(m=>{var g;return m((g=t())!=null?g:p)});const I=((S=n.onRehydrateStorage)==null?void 0:S.call(n,(l=t())!=null?l:p))||void 0;return w(c.getItem.bind(c))(n.name).then(m=>{if(m)if(typeof m.version=="number"&&m.version!==n.version){if(n.migrate){const g=n.migrate(m.state,m.version);return g instanceof Promise?g.then(v=>[!0,v]):[!0,g]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,m.state];return[!1,void 0]}).then(m=>{var g;const[v,A]=m;if(h=n.merge(A,(g=t())!=null?g:p),e(h,!0),v)return f()}).then(()=>{I?.(h,void 0),h=t(),a=!0,d.forEach(m=>m(h))}).catch(m=>{I?.(void 0,m)})};return r.persist={setOptions:l=>{n={...n,...l},l.storage&&(c=l.storage)},clearStorage:()=>{c?.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:l=>(u.add(l),()=>{u.delete(l)}),onFinishHydration:l=>(d.add(l),()=>{d.delete(l)})},n.skipHydration||x(),h||p},P=R,k=()=>Math.random().toString(36).substr(2,9),W=B()(P((s,o)=>({user:null,isAuthenticated:!1,setUser:e=>s({user:e,isAuthenticated:!!e}),login:async(e,t)=>{const n=JSON.parse(localStorage.getItem("mockUsers")||"[]").find(a=>a.email===e);if(n)s({user:n,isAuthenticated:!0});else throw new Error("Invalid credentials")},signup:async(e,t,r)=>{const n={id:k(),name:e,email:t,plan:"free",createdAt:new Date().toISOString()},a=JSON.parse(localStorage.getItem("mockUsers")||"[]");a.push(n),localStorage.setItem("mockUsers",JSON.stringify(a)),s({user:n,isAuthenticated:!0})},logout:()=>{s({user:null,isAuthenticated:!1,currentWorkspaceId:null,currentBoardId:null})},theme:"light",toggleTheme:()=>{s(e=>({theme:e.theme==="light"?"dark":"light"}))},workspaces:[],currentWorkspaceId:null,setCurrentWorkspace:e=>s({currentWorkspaceId:e}),createWorkspace:(e,t)=>{const r=o().user;if(!r)return;const n={id:k(),name:e,description:t,ownerId:r.id,memberIds:[r.id],createdAt:new Date().toISOString()};s(a=>({workspaces:[...a.workspaces,n]}))},boards:[],currentBoardId:null,setCurrentBoard:e=>s({currentBoardId:e}),createBoard:(e,t,r)=>{const n=["bg-cyan-500","bg-teal-500","bg-emerald-500","bg-sky-500","bg-blue-500"],a={id:k(),title:e,workspaceId:t,description:r,color:n[Math.floor(Math.random()*n.length)],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};s(d=>({boards:[...d.boards,a]})),[{title:"To Do",color:"#06b6d4"},{title:"In Progress",color:"#14b8a6"},{title:"Done",color:"#10b981"}].forEach((d,c)=>{o().createColumn(d.title,a.id,d.color)})},updateBoard:(e,t)=>{s(r=>({boards:r.boards.map(n=>n.id===e?{...n,...t,updatedAt:new Date().toISOString()}:n)}))},deleteBoard:e=>{s(t=>({boards:t.boards.filter(r=>r.id!==e),columns:t.columns.filter(r=>r.boardId!==e),tasks:t.tasks.filter(r=>r.boardId!==e)}))},columns:[],createColumn:(e,t,r)=>{const n={id:k(),title:e,boardId:t,order:o().columns.filter(a=>a.boardId===t).length,color:r||"#06b6d4"};s(a=>({columns:[...a.columns,n]}))},updateColumn:(e,t)=>{s(r=>({columns:r.columns.map(n=>n.id===e?{...n,...t}:n)}))},deleteColumn:e=>{s(t=>({columns:t.columns.filter(r=>r.id!==e),tasks:t.tasks.filter(r=>r.columnId!==e)}))},reorderColumns:e=>{s(t=>({columns:t.columns.map(r=>({...r,order:e.indexOf(r.id)}))}))},tasks:[],createTask:e=>{const t={...e,id:k(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};s(r=>({tasks:[...r.tasks,t]}))},updateTask:(e,t)=>{s(r=>({tasks:r.tasks.map(n=>n.id===e?{...n,...t,updatedAt:new Date().toISOString()}:n)}))},deleteTask:e=>{s(t=>({tasks:t.tasks.filter(r=>r.id!==e)}))},moveTask:(e,t)=>{s(r=>({tasks:r.tasks.map(n=>n.id===e?{...n,columnId:t,updatedAt:new Date().toISOString()}:n)}))},getTaskStats:()=>{const{tasks:e,columns:t}=o(),r=t.find(i=>i.title.toLowerCase().includes("done")),n=t.find(i=>i.title.toLowerCase().includes("progress")),a=r?e.filter(i=>i.columnId===r.id).length:0,u=n?e.filter(i=>i.columnId===n.id).length:0,d=e.length,c=d-a-u,f=e.filter(i=>i.dueDate&&new Date(i.dueDate)<new Date&&i.columnId!==r?.id).length;return{total:d,completed:a,inProgress:u,pending:c,overdue:f}}}),{name:"collabboard-storage",partialize:s=>({user:s.user,isAuthenticated:s.isAuthenticated,theme:s.theme,workspaces:s.workspaces,boards:s.boards,columns:s.columns,tasks:s.tasks})})),_=C.forwardRef(({className:s,label:o,error:e,icon:t,...r},n)=>b.jsxs("div",{className:"w-full",children:[o&&b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o}),b.jsxs("div",{className:"relative",children:[t&&b.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:t}),b.jsx("input",{ref:n,...r,className:D("w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-700","bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500","transition-all duration-200",t&&"pl-10",e&&"border-red-500 focus:ring-red-500",s)})]}),e&&b.jsx("p",{className:"mt-1 text-sm text-red-500",children:e})]}));_.displayName="Input";export{_ as I,W as u};
